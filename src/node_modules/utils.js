import { get } from 'svelte/store';
import { urls } from '../stores/urlStore';

export function post(endpoint, data = {}) {
	return fetch(endpoint, {
		method: 'POST',
		credentials: 'include',
		body: JSON.stringify(data),
		headers: {
			'Content-Type': 'application/json',
		}
	}).then(r => r.json());
}
export function del(endpoint, id) {
	return fetch(endpoint, {
		method: 'DELETE',
		credentials: 'include',
		body: id,
		headers: {
			'Content-Type': 'application/json',
		}
	}).then(r => r.json());
}
export function put(endpoint, data={}) {
	return fetch(endpoint, {
		method: 'PUT',
		credentials: 'include',
		body: JSON.stringify(data),
		headers: {
			'Content-Type': 'application/json',
		}
	}).then(r => r.json());
}
export function cache(id, user) {
	if (user && user.token) {
		let url = get(urls)[id];
		return url && `${url}/?token=${user.token}` || false;
	}
	return false;
}
export function getExt(fn) {
	let match = fn && fn.match(/[A-Za-z0-9]+$/) || [];
	return match.length && match[0].toLowerCase();
}