import{r as t,c as s,h as i}from"./p-6a8a5b8e.js";import{P as a}from"./p-7e342812.js";import{b as h}from"./p-d22fa63b.js";import{c as e}from"./p-1f4b6ee8.js";import{w as r}from"./p-0d94bd6e.js";import"./p-d8b735e7.js";import"./p-bd8dee20.js";import{M as o}from"./p-8b74fa0e.js";import"./p-cab62385.js";import{a as c}from"./p-03f3cfce.js";import{d as n}from"./p-b0ea4d0d.js";const d=class{constructor(i){t(this,i),this.vLoadStart=s(this,"vLoadStart",7),this.hasAttached=!1,this.version="latest",this.config={},this.preload="metadata"}onSrcChange(){this.hasAttached&&(this.vLoadStart.emit(),this.dash.attachSource(this.src))}componentWillLoad(){this.dispatch=e(this)}async componentDidLoad(){try{const t=`https://cdn.jsdelivr.net/npm/dashjs@${this.version}/dist/dash.all.min.js`,s=await c(t,"dashjs"),i=this.videoProvider.querySelector("video");this.dash=s.MediaPlayer(this.config).create(),this.dash.initialize(i,null,this.autoplay),this.dash.on(s.MediaPlayer.events.CAN_PLAY,()=>{this.dispatch(a.mediaType,o.Video),this.dispatch(a.currentSrc,this.src),this.dispatch(a.playbackReady,!0)}),this.dash.on(s.MediaPlayer.events.ERROR,t=>{this.dispatch(a.errors,[t])}),this.hasAttached=!0}catch(t){this.dispatch(a.errors,[t])}}disconnectedCallback(){var t;null===(t=this.dash)||void 0===t||t.reset(),this.dash=void 0,this.hasAttached=!1}async getAdapter(){const t=await this.videoProvider.getAdapter(),s=t.canPlay;return Object.assign(Object.assign({},t),{getInternalPlayer:async()=>this.dash,canPlay:async t=>h(t)&&n.test(t)||s(t)})}render(){return i("vime-video",{willAttach:!0,crossOrigin:this.crossOrigin,preload:this.preload,poster:this.poster,controlsList:this.controlsList,autoPiP:this.autoPiP,disablePiP:this.disablePiP,disableRemotePlayback:this.disableRemotePlayback,mediaTitle:this.mediaTitle,ref:t=>{this.videoProvider=t}})}static get watchers(){return{src:["onSrcChange"],hasAttached:["onSrcChange"]}}};r(d,[a.autoplay]);export{d as vime_dash}