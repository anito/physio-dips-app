import{r as i,c as t,h as s,H as e,f as n}from"./p-7d485867.js";import{P as o}from"./p-d8000c6e.js";import{e as a}from"./p-eef3d203.js";import{c as r}from"./p-59c69388.js";import{w as h,f as l}from"./p-e9fb6631.js";import"./p-29d1ed0b.js";import{l as c}from"./p-bd8dee20.js";import{a as d,d as v}from"./p-0d34702b.js";import{c as u}from"./p-64e9395d.js";import{D as p}from"./p-874fa941.js";const m=class{constructor(s){i(this,s),this.vTrackChange=t(this,"vTrackChange",3),this.vCuesChange=t(this,"vCuesChange",3),this.textTracksDisposal=new p,this.textTrackDisposal=new p,this.state=new Map,this.isEnabled=!1,this.activeCues=[],this.hidden=!1,this.controlsHeight=0,this.isControlsActive=!1,this.isVideoView=!1,this.playbackStarted=!1}onActiveTrackChange(){this.vTrackChange.emit(this.activeTrack)}onActiveCuesChange(){this.vCuesChange.emit(this.activeCues)}disconnectedCallback(){this.cleanup()}cleanup(){this.state.clear(),this.textTracksDisposal.empty(),this.textTrackDisposal.empty()}onCueChange(){var i,t;this.activeCues=Array.from(null!==(t=null===(i=this.activeTrack)||void 0===i?void 0:i.activeCues)&&void 0!==t?t:[])}onTrackChange(){this.activeCues=[],this.textTrackDisposal.empty(),a(this.activeTrack)||this.textTrackDisposal.add(c(this.activeTrack,"cuechange",this.onCueChange.bind(this)))}findActiveTrack(){let i;return Array.from(this.textTracks).forEach(t=>{a(i)&&"showing"===t.mode?(t.mode="hidden",i=t,this.state.set(t,"hidden")):(t.mode="disabled",this.state.set(t,"disabled"))}),i}onTracksChange(){let i=!1;if(Array.from(this.textTracks).forEach(t=>{i||(i=!this.state.has(t)||t.mode!==this.state.get(t)),this.state.set(t,t.mode)}),i){const i=this.findActiveTrack();this.activeTrack!==i&&(this.activeTrack=i,this.onTrackChange())}}onTextTracksListChange(){this.cleanup(),a(this.textTracks)||(this.onTracksChange(),this.textTracksDisposal.add(c(this.textTracks,"change",this.onTracksChange.bind(this))))}onEnabledChange(){this.isEnabled=this.playbackStarted&&this.isVideoView}renderCurrentCue(){const i=this.activeCues[0];if(a(i))return"";const t=document.createElement("div");return t.append(i.getCueAsHTML()),t.innerHTML.trim()}render(){return s(e,{style:{transform:`translateY(-${this.isControlsActive?this.controlsHeight:0}px)`},class:{enabled:this.isEnabled,hidden:this.hidden}},s("span",null,this.renderCurrentCue()))}static get watchers(){return{activeTrack:["onActiveTrackChange"],activeCues:["onActiveCuesChange"],textTracks:["onTextTracksListChange"],isVideoView:["onEnabledChange"],playbackStarted:["onEnabledChange"]}}};h(m,[o.IsVideoView,o.PlaybackStarted,o.IsControlsActive,o.TextTracks]),m.style="vime-captions{position:absolute;left:0;bottom:0;width:100%;text-align:center;color:var(--captions-text-color);font-size:var(--captions-font-size);padding:var(--control-spacing);z-index:30;display:none;pointer-events:none;transition:transform 0.4s ease-in-out}vime-captions.enabled{display:inline-block}vime-captions.hidden{display:none !important}@media (min-width: 768px){vime-captions{font-size:var(--captions-font-size-medium)}}@media (min-width: 992px){vime-captions{font-size:var(--captions-font-size-large)}}@media (min-width: 1200px){vime-captions{font-size:var(--captions-font-size-xlarge)}}vime-captions>span{display:inline-block;background:var(--captions-cue-bg-color);border-radius:var(--captions-cue-border-radius);box-decoration-break:clone;line-height:185%;padding:var(--captions-cue-padding);white-space:pre-wrap;pointer-events:none}vime-captions>span :global(div){display:inline}vime-captions>span:empty{display:none}";const b=class{constructor(t){i(this,t),this.useOnMobile=!1,this.paused=!0,this.isVideoView=!1}componentWillLoad(){this.dispatch=r(this)}onClick(){this.dispatch(o.Paused,!this.paused)}render(){return s(e,{class:{enabled:this.isVideoView&&(!d||this.useOnMobile)},onClick:this.onClick.bind(this)})}};h(b,[o.Paused,o.IsVideoView]),b.style="vime-click-to-play{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:auto;z-index:20;display:none}vime-click-to-play.enabled{display:inline-block}";const g=class{constructor(t){i(this,t),this.activeDuration=2750,this.waitForPlaybackStart=!1,this.hideWhenPaused=!1,this.hideOnMouseLeave=!1,this.isMobile=!1,this.isLive=!1,this.isAudioView=!1,this.isVideoView=!1}buildAudioControls(){return s("vime-controls",{"full-width":!0},s("vime-playback-control",{"tooltip-direction":"right"}),s("vime-volume-control",null),!this.isLive&&s("vime-current-time",null),this.isLive&&s("vime-control-spacer",null),!this.isLive&&s("vime-scrubber-control",null),this.isLive&&s("vime-live-indicator",null),!this.isLive&&s("vime-end-time",null),!this.isLive&&s("vime-settings-control",{"tooltip-direction":"left"}),s("div",{style:{paddingRight:"2px"}}))}buildMobileVideoControls(){const i=s("vime-controls",{pin:"bottomLeft","full-width":!0,activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused},s("vime-control-group",null,s("vime-current-time",null),s("vime-control-spacer",null),s("vime-end-time",null),s("vime-fullscreen-control",null)),s("vime-control-group",{space:"top"},s("vime-scrubber-control",null)));return s(e,null,s("vime-scrim",null),s("vime-controls",{pin:"topLeft","full-width":!0,activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused},s("vime-control-spacer",null),s("vime-volume-control",null),!this.isLive&&s("vime-caption-control",null),!this.isLive&&s("vime-settings-control",null),this.isLive&&s("vime-fullscreen-control",null)),s("vime-controls",{pin:"center",activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused},s("vime-playback-control",{scale:1.5})),!this.isLive&&i)}buildDesktopVideoControls(){const i=s("vime-control-group",null,s("vime-scrubber-control",null));return s(e,null,s("vime-scrim",{gradient:"up"}),s("vime-controls",{activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused,hideOnMouseLeave:this.hideOnMouseLeave,"full-width":!0},!this.isLive&&i,s("vime-control-group",{space:this.isLive?"none":"top"},s("vime-playback-control",{"tooltip-direction":"right"}),s("vime-volume-control",null),!this.isLive&&s("vime-time-progress",null),s("vime-control-spacer",null),!this.isLive&&s("vime-caption-control",null),this.isLive&&s("vime-live-indicator",null),s("vime-pip-control",null),!this.isLive&&s("vime-settings-control",null),s("vime-fullscreen-control",{"tooltip-direction":"left"}))))}render(){return this.isAudioView?this.buildAudioControls():this.isVideoView&&this.isMobile?this.buildMobileVideoControls():this.isVideoView?this.buildDesktopVideoControls():void 0}};h(g,[o.IsMobile,o.IsAudioView,o.IsVideoView,o.IsLive]),g.style="vime-default-controls{width:100%}";const f=class{constructor(t){i(this,t),this.textTracksDisposal=new p,this.i18n={},this.playbackRate=1,this.playbackRates=[1],this.playbackQualities=[],this.isCaptionsActive=!1,this.skipFirstRender=!0}onTextTracksChange(){this.textTracksDisposal.empty(),a(this.textTracks)||this.textTracksDisposal.add(c(this.textTracks,"change",()=>{setTimeout(()=>n(this),300)}))}componentWillLoad(){this.skipFirstRender=!0,this.player=l(this),this.dispatch=r(this)}componentWillRender(){if(!this.skipFirstRender)return Promise.all([this.buildPlaybackRateSubmenu(),this.buildPlaybackQualitySubmenu(),this.buildCaptionsSubmenu()]);this.skipFirstRender=!1}disconnectedCallback(){this.player=void 0,this.textTracksDisposal.empty()}onPlaybackRateSelect(i){this.dispatch(o.PlaybackRate,parseFloat(i.target.value))}async buildPlaybackRateSubmenu(){var i;const t=await(null===(i=this.player)||void 0===i?void 0:i.canSetPlaybackRate());if(1===this.playbackRates.length||!t)return void(this.rateSubmenu=s("vime-menu-item",{label:this.i18n.playbackRate,hint:this.i18n.normal}));const e=i=>1===i?this.i18n.normal:""+i,n=this.playbackRates.map(i=>s("vime-menu-radio",{label:e(i),value:""+i}));this.rateSubmenu=s("vime-submenu",{label:this.i18n.playbackRate,hint:e(this.playbackRate)},s("vime-menu-radio-group",{value:""+this.playbackRate,onVCheck:this.onPlaybackRateSelect.bind(this)},n))}onPlaybackQualitySelect(i){this.dispatch(o.PlaybackQuality,i.target.value)}async buildPlaybackQualitySubmenu(){var i,t;const e=await(null===(i=this.player)||void 0===i?void 0:i.canSetPlaybackQuality());if(0===this.playbackQualities.length||!e)return void(this.qualitySubmenu=s("vime-menu-item",{label:this.i18n.playbackQuality,hint:null!==(t=this.playbackQuality)&&void 0!==t?t:this.i18n.auto}));const n=i=>{const t=parseInt(i.slice(0,-1),10);return t>2160?"UHD":t>=1080?"HD":void 0},o=this.playbackQualities.map(i=>s("vime-menu-radio",{label:i,value:i,badge:n(i)}));this.qualitySubmenu=s("vime-submenu",{label:this.i18n.playbackQuality,hint:this.playbackQuality},s("vime-menu-radio-group",{value:this.playbackQuality,onVCheck:this.onPlaybackQualitySelect.bind(this)},o))}async onCaptionSelect(i){var t;const s=parseInt(i.target.value,10),e=l(this);if(-1===s)return void await e.toggleCaptionsVisiblity(!1);const n=Array.from(null!==(t=this.textTracks)&&void 0!==t?t:[])[s];a(n)||(a(this.currentCaption)||(this.currentCaption.mode="disabled"),n.mode="showing",await e.toggleCaptionsVisiblity(!0))}async buildCaptionsSubmenu(){var i,t,e;const n=Array.from(null!==(i=this.textTracks)&&void 0!==i?i:[]).filter(i=>["captions","subtitles"].includes(i.kind));if(0===n.length)return void(this.captionsSubmenu=s("vime-menu-item",{label:this.i18n.subtitlesOrCc,hint:this.i18n.none}));const o=i=>""+Array.from(this.textTracks).findIndex(t=>t===i),r=[s("vime-menu-radio",{label:this.i18n.off,value:"-1"})].concat(n.map(i=>s("vime-menu-radio",{label:i.label,value:o(i)}))),h=!this.isCaptionsActive||a(this.currentCaption)?"-1":o(this.currentCaption);this.captionsSubmenu=s("vime-submenu",{label:this.i18n.subtitlesOrCc,hint:null!==(e=this.isCaptionsActive?null===(t=this.currentCaption)||void 0===t?void 0:t.label:void 0)&&void 0!==e?e:this.i18n.off},s("vime-menu-radio-group",{value:h,onVCheck:this.onCaptionSelect.bind(this)},r))}render(){return s("vime-settings",null,this.rateSubmenu,this.qualitySubmenu,this.captionsSubmenu,s("slot",null))}static get watchers(){return{textTracks:["onTextTracksChange"]}}};h(f,[o.I18N,o.PlaybackRate,o.PlaybackRates,o.PlaybackQuality,o.PlaybackQualities,o.IsCaptionsActive,o.CurrentCaption,o.TextTracks]);const y=new Set,k=class{constructor(t){i(this,t),this.href="https://cdn.jsdelivr.net/npm/@vime/core@latest/icons/sprite.svg"}componentWillLoad(){if(!y.has(this.href))return y.add(this.href),u(this.href)}},C=class{constructor(s){i(this,s),this.vLoaded=t(this,"vLoaded",3),this.vWillShow=t(this,"vWillShow",3),this.vWillHide=t(this,"vWillHide",3),this.isHidden=!0,this.isActive=!1,this.hasLoaded=!1,this.fit="cover",this.isVideoView=!1,this.playbackStarted=!1}onCurrentPosterChange(){this.hasLoaded=!1}componentWillLoad(){this.onEnabledChange(),this.onActiveChange()}onVisibilityChange(){!this.isHidden&&this.isActive?this.vWillShow.emit():this.vWillHide.emit()}onEnabledChange(){this.isHidden=!this.isVideoView||a(this.currentPoster),this.onVisibilityChange()}onActiveChange(){this.isActive=!this.playbackStarted,this.onVisibilityChange()}onPosterLoad(){this.vLoaded.emit(),this.hasLoaded=!0}render(){return s(e,{class:{hidden:this.isHidden,active:this.isActive&&this.hasLoaded}},s("img",{class:"lazy","data-src":this.currentPoster,alt:a(this.mediaTitle)?"Media Poster":this.mediaTitle+" Poster",style:{objectFit:this.fit},onLoad:this.onPosterLoad.bind(this)}))}static get watchers(){return{currentPoster:["onCurrentPosterChange","onEnabledChange"],isVideoView:["onEnabledChange"],playbackStarted:["onActiveChange"]}}};h(C,[o.MediaTitle,o.CurrentPoster,o.PlaybackStarted,o.IsVideoView]),C.style="vime-poster{position:absolute;top:0;left:0;width:100%;height:100%;background:#000;z-index:1;display:inline-block;pointer-events:none;opacity:0;visibility:hidden;transition:var(--player-fade-transition, opacity 0.4s ease-in-out)}vime-poster.hidden{display:none}vime-poster.active{opacity:1;visibility:visible}vime-poster>img{width:100%;height:100%;pointer-events:none}";const w=class{constructor(s){i(this,s),this.vWillShow=t(this,"vWillShow",3),this.vWillHide=t(this,"vWillHide",3),this.isHidden=!0,this.isActive=!1,this.isVideoView=!1,this.buffering=!1}onVideoViewChange(){this.isHidden=!this.isVideoView,this.onVisiblityChange()}onActiveChange(){this.isActive=this.buffering,this.onVisiblityChange()}onVisiblityChange(){!this.isHidden&&this.isActive?this.vWillShow.emit():this.vWillHide.emit()}render(){return s(e,{class:{hidden:this.isHidden,active:this.isActive}},s("div",null,"Loading..."))}static get watchers(){return{isVideoView:["onVideoViewChange"],buffering:["onActiveChange"]}}};h(w,[o.IsVideoView,o.Buffering]),w.style="vime-spinner{position:absolute;top:0;left:0;width:100%;height:100%;justify-content:center;align-items:center;pointer-events:none;z-index:40;display:flex;opacity:0;visibility:hidden;transition:var(--player-fade-transition, opacity 0.4s ease-in-out)}vime-spinner.hidden{display:none}vime-spinner.active{opacity:1;visibility:visible}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}vime-spinner>div{background:transparent;margin:60px auto;font-size:10px;position:relative;text-indent:-9999em;pointer-events:none;border-top:var(--spinner-thickness) solid var(--spinner-fill-color);border-left:var(--spinner-thickness) solid var(--spinner-fill-color);border-right:var(--spinner-thickness) solid var(--spinner-track-color);border-bottom:var(--spinner-thickness) solid var(--spinner-track-color);transform:translateZ(0);animation:spin var(--spinner-spin-duration) infinite var(--spinner-spin-timing-func)}vime-spinner>div,vime-spinner>div::after{border-radius:50%;width:var(--spinner-width);height:var(--spinner-height)}";const x=class{constructor(t){i(this,t),this.isVideoView=!1,this.playsinline=!1,this.isFullscreenActive=!1}render(){const i=!v||!this.isVideoView||this.playsinline&&!this.isFullscreenActive;return s(e,{class:{hidden:!i,video:this.isVideoView}},s("div",null,i&&s("slot",null)))}};h(x,[o.IsVideoView,o.Playsinline,o.IsFullscreenActive]),x.style="vime-ui{pointer-events:none;z-index:2;width:100%}vime-ui.hidden{display:none}vime-ui.video{position:absolute;top:0;left:0;height:100%}";export{m as vime_captions,b as vime_click_to_play,g as vime_default_controls,f as vime_default_settings,k as vime_icons,C as vime_poster,w as vime_spinner,x as vime_ui}